(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-15e98ed1"],{1409:function(t,e,a){"use strict";var o=a("90d4"),s=a.n(o);s.a},3530:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"admin mt-4"},[a("loading",{attrs:{active:t.isLoading},on:{"update:active":function(e){t.isLoading=e}}},[a("template",{slot:"before"},[t._v("Please wait")]),a("template",{slot:"after"},[t._v("loading")])],2),a("Hamburger"),a("div",{staticClass:"menu d-flex ml-2"},[a("div",{staticClass:"form-group d-flex"},[a("label",{staticClass:"mr-2 col-form-label text-right",attrs:{for:"cityName"}},[t._v("縣市")]),a("div",{staticClass:"flex-fill"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.select.city,expression:"select.city"}],staticClass:"form-control",attrs:{id:"cityName"},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.select,"city",e.target.multiple?a:a[0])},function(e){return t.citySearch()}]}},[a("option",{attrs:{value:""}},[t._v("-- Select One --")]),t._l(t.cityName,(function(e){return a("option",{key:e.CityName,domProps:{value:e.CityName}},[t._v(t._s(e.CityName))])}))],2)])]),a("div",{staticClass:"form-group d-flex ml-1"},[a("label",{staticClass:"mr-2 col-form-label text-right",attrs:{for:"area"}},[t._v("店名")]),a("div",{staticClass:"flex-fill"},[a("div",{staticClass:"input-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.searchText,expression:"searchText"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Search","aria-label":"Search"},domProps:{value:t.searchText},on:{input:[function(e){e.target.composing||(t.searchText=e.target.value)},function(e){return t.search()}]}})])])]),a("button",{staticClass:"btn btn-primary btn-open-place",on:{click:function(e){return t.openModal(!0)}}},[t._v("建立新地點")]),a("button",{staticClass:"btn btn-primary signout",on:{click:function(e){return e.preventDefault(),t.signout(e)}}},[t._v("登出")])]),""===t.searchText&&""===t.select.city?a("table",{staticClass:"table mt-2"},[t._m(0),a("tbody",t._l(t.data,(function(e){return a("tr",{key:e._id},[a("td",[t._v(t._s(e.category))]),a("td",[t._v(t._s(e.county))]),a("td",[t._v(t._s(e.town))]),a("td",[t._v(t._s(e.name))]),a("td",[t._v(t._s(e.recommended))]),a("td",[a("div",{staticStyle:{display:"inline-block",width:"100px"}},[a("button",{staticClass:"btn btn-outline-primary btn-sm",on:{click:function(a){return t.openModal(!1,e)}}},[t._v("編輯")]),a("button",{staticClass:"btn btn-outline-primary btn-sm",on:{click:function(a){return t.delModal(e)}}},[t._v("刪除")])])])])})),0)]):t._e(),""!==t.select.city&&""===t.searchText?a("table",{staticClass:"table mt-2"},[t._m(1),a("tbody",t._l(t.data,(function(e){return a("tr",{key:e._id},[a("td",[t._v(t._s(e.category))]),a("td",[t._v(t._s(e.county))]),a("td",[t._v(t._s(e.town))]),a("td",[t._v(t._s(e.name))]),a("td",[t._v(t._s(e.recommended))]),a("td",[a("div",{staticStyle:{display:"inline-block",width:"100px"}},[a("button",{staticClass:"btn btn-outline-primary btn-sm",on:{click:function(a){return t.openModal(!1,e)}}},[t._v("編輯")]),a("button",{staticClass:"btn btn-outline-primary btn-sm",on:{click:function(a){return t.delModal(e)}}},[t._v("刪除")])])])])})),0)]):t._e(),""!=t.searchText?a("table",{staticClass:"table mt-2"},[t._m(2),a("tbody",t._l(t.filterData,(function(e){return a("tr",{key:e._id},[a("td",[t._v(t._s(e.category))]),a("td",[t._v(t._s(e.county))]),a("td",[t._v(t._s(e.town))]),a("td",[t._v(t._s(e.name))]),a("td",[t._v(t._s(e.recommended))]),a("td",[a("div",{staticStyle:{display:"inline-block",width:"100px"}},[a("button",{staticClass:"btn btn-outline-primary btn-sm",on:{click:function(a){return t.openModal(!1,e)}}},[t._v("編輯")]),a("button",{staticClass:"btn btn-outline-primary btn-sm",on:{click:function(a){return t.delModal(e)}}},[t._v("刪除")])])])])})),0)]):t._e(),a("div",{staticClass:"modal fade",attrs:{id:"locationModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog modal-lg",attrs:{role:"document"}},[a("div",{staticClass:"modal-content border-0"},[t._m(3),a("div",{staticClass:"modal-body"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-4"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"county"}},[t._v("county")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempLocation.county,expression:"tempLocation.county"}],staticClass:"form-control",attrs:{type:"text",id:"county",placeholder:"請輸入"},domProps:{value:t.tempLocation.county},on:{input:function(e){e.target.composing||t.$set(t.tempLocation,"county",e.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"food"}},[t._v("food")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempLocation.food,expression:"tempLocation.food"}],staticClass:"form-control",attrs:{type:"text",id:"food",placeholder:"請輸入"},domProps:{value:t.tempLocation.food},on:{input:function(e){e.target.composing||t.$set(t.tempLocation,"food",e.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"Recommended"}},[t._v("Recommended")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempLocation.recommended,expression:"tempLocation.recommended"}],staticClass:"form-control",attrs:{type:"text",id:"recommended",placeholder:"請輸入"},domProps:{value:t.tempLocation.recommended},on:{input:function(e){e.target.composing||t.$set(t.tempLocation,"recommended",e.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"url"}},[t._v("url")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempLocation.url,expression:"tempLocation.url"}],staticClass:"form-control",attrs:{type:"url",id:"url",placeholder:"請輸入"},domProps:{value:t.tempLocation.url},on:{input:function(e){e.target.composing||t.$set(t.tempLocation,"url",e.target.value)}}})])]),a("div",{staticClass:"col-sm-4"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"town"}},[t._v("town")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempLocation.town,expression:"tempLocation.town"}],staticClass:"form-control",attrs:{type:"text",id:"town",placeholder:"請輸入"},domProps:{value:t.tempLocation.town},on:{input:function(e){e.target.composing||t.$set(t.tempLocation,"town",e.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"name"}},[t._v("name")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempLocation.name,expression:"tempLocation.name"}],staticClass:"form-control",attrs:{type:"text",id:"name",placeholder:"請輸入"},domProps:{value:t.tempLocation.name},on:{input:function(e){e.target.composing||t.$set(t.tempLocation,"name",e.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"cost"}},[t._v("cost")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempLocation.cost,expression:"tempLocation.cost"}],staticClass:"form-control",attrs:{type:"number",id:"cost",placeholder:"請輸入"},domProps:{value:t.tempLocation.cost},on:{input:function(e){e.target.composing||t.$set(t.tempLocation,"cost",e.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"latitude"}},[t._v("緯度")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempLocation.geometry.coordinates[1],expression:"tempLocation.geometry.coordinates[1]"}],staticClass:"form-control",attrs:{type:"number",id:"latitude",placeholder:"請輸入"},domProps:{value:t.tempLocation.geometry.coordinates[1]},on:{input:function(e){e.target.composing||t.$set(t.tempLocation.geometry.coordinates,1,e.target.value)}}})])]),a("div",{staticClass:"col-sm-4"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"category"}},[t._v("category")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempLocation.category,expression:"tempLocation.category"}],staticClass:"form-control",attrs:{type:"text",id:"category",placeholder:"請輸入"},domProps:{value:t.tempLocation.category},on:{input:function(e){e.target.composing||t.$set(t.tempLocation,"category",e.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"phone"}},[t._v("phone")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempLocation.phone,expression:"tempLocation.phone"}],staticClass:"form-control",attrs:{type:"tel",id:"phone",placeholder:"請輸入"},domProps:{value:t.tempLocation.phone},on:{input:function(e){e.target.composing||t.$set(t.tempLocation,"phone",e.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"score"}},[t._v("score")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempLocation.score,expression:"tempLocation.score"}],staticClass:"form-control",attrs:{type:"number",step:"0.1",min:"0",max:"5",id:"score",placeholder:"請輸入"},domProps:{value:t.tempLocation.score},on:{input:function(e){e.target.composing||t.$set(t.tempLocation,"score",e.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"longitude"}},[t._v("經度")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempLocation.geometry.coordinates[0],expression:"tempLocation.geometry.coordinates[0]"}],staticClass:"form-control",attrs:{type:"number",step:"0.0000001",id:"longitude",placeholder:"請輸入"},domProps:{value:t.tempLocation.geometry.coordinates[0]},on:{input:function(e){e.target.composing||t.$set(t.tempLocation.geometry.coordinates,0,e.target.value)}}})])])]),a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"address"}},[t._v("address")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.tempLocation.address,expression:"tempLocation.address"}],staticClass:"form-control",attrs:{type:"text",id:"address",placeholder:"請輸入"},domProps:{value:t.tempLocation.address},on:{input:function(e){e.target.composing||t.$set(t.tempLocation,"address",e.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"business_hours"}},[t._v("business_hours")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.tempLocation.business_hours,expression:"tempLocation.business_hours"}],staticClass:"form-control",attrs:{type:"text",id:"business_hours",placeholder:"請輸入"},domProps:{value:t.tempLocation.business_hours},on:{input:function(e){e.target.composing||t.$set(t.tempLocation,"business_hours",e.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"description"}},[t._v("description")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.tempLocation.description,expression:"tempLocation.description"}],staticClass:"form-control",attrs:{type:"text",id:"description",placeholder:"請輸入"},domProps:{value:t.tempLocation.description},on:{input:function(e){e.target.composing||t.$set(t.tempLocation,"description",e.target.value)}}})])])])]),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-outline-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v("取消")]),a("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:t.updateLocation}},[t._v("確認")])])])])]),a("div",{staticClass:"modal fade",attrs:{id:"delLocationModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[a("div",{staticClass:"modal-content border-0"},[t._m(4),a("div",{staticClass:"modal-body"},[t._v(" 是否刪除 "),a("strong",{staticClass:"text-danger"},[t._v(t._s(t.deleteName))]),t._v(" 地點(刪除後將無法恢復)。 ")]),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-outline-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v("取消")]),a("button",{staticClass:"btn btn-danger",attrs:{type:"button"},on:{click:t.deleteLocation}},[t._v("確認刪除")])])])])]),""===t.searchText&&""===t.select.city?a("Pagination",{attrs:{pageNum:t.pagination},on:{getPage:t.getLocation}}):t._e()],1)},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",{attrs:{width:"80"}},[t._v("類別")]),a("th",{attrs:{width:"80"}},[t._v("城市")]),a("th",{attrs:{width:"80"}},[t._v("地區")]),a("th",{attrs:{width:"120"}},[t._v("店名")]),a("th",{attrs:{width:"100"}},[t._v("推薦食物")]),a("th",{attrs:{width:"80"}},[t._v("編輯")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",{attrs:{width:"80"}},[t._v("類別")]),a("th",{attrs:{width:"80"}},[t._v("城市")]),a("th",{attrs:{width:"80"}},[t._v("地區")]),a("th",{attrs:{width:"120"}},[t._v("店名")]),a("th",{attrs:{width:"100"}},[t._v("推薦食物")]),a("th",{attrs:{width:"80"}},[t._v("編輯")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",{attrs:{width:"80"}},[t._v("類別")]),a("th",{attrs:{width:"80"}},[t._v("城市")]),a("th",{attrs:{width:"80"}},[t._v("地區")]),a("th",{attrs:{width:"120"}},[t._v("店名")]),a("th",{attrs:{width:"100"}},[t._v("推薦食物")]),a("th",{attrs:{width:"80"}},[t._v("編輯")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-header bg-dark text-white"},[a("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[a("span",[t._v("新增地點")])]),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-header bg-danger text-white"},[a("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[a("span",[t._v("刪除地點")])]),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])}],i=(a("99af"),a("4de4"),a("4160"),a("caad"),a("b0c0"),a("2532"),a("159b"),a("5530")),n=(a("96cf"),a("1da1")),r=a("1157"),c=a.n(r),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("nav",{attrs:{"aria-label":"Page navigation example"}},[a("ul",{staticClass:"pagination"},[a("li",{staticClass:"page-item",class:{disable:!t.pageNum.has_pre}},[a("a",{staticClass:"page-link",attrs:{href:"#","aria-label":"Previous"},on:{click:function(e){return e.preventDefault(),t.getPage(t.pageNum.current_page-1)}}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("«")]),a("span",{staticClass:"sr-only"},[t._v("Previous")])])]),t._l(t.pageNum.total_pages,(function(e){return a("li",{key:e,staticClass:"page-item",class:{active:t.pageNum.current_page===e}},[a("a",{staticClass:"page-link",attrs:{href:"#"},on:{click:function(a){return a.preventDefault(),t.getPage(e)}}},[t._v(t._s(e))])])})),a("li",{staticClass:"page-item"},[a("a",{staticClass:"page-link",attrs:{href:"#","aria-label":"Next"},on:{click:function(e){return e.preventDefault(),t.getPage(t.pageNum.current_page+1)}}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("»")]),a("span",{staticClass:"sr-only"},[t._v("Next")])])])],2)])])},d=[],m={props:{pageNum:{type:Object}},methods:{getPage:function(t){this.$emit("getPage",t)}}},u=m,p=(a("cc41"),a("2877")),v=Object(p["a"])(u,l,d,!1,null,"3ac98406",null),g=v.exports,f=a("a9e8"),h=a("f9c6"),_=a("9661"),b={components:{Pagination:g,Hamburger:f["a"]},data:function(){return{allData:[],data:[],filterData:[],cityFilterData:[],searchText:"",cityName:h,select:{city:"",area:"",category:""},allPagination:{},pagination:{},tempLocation:{geometry:{type:"Point",coordinates:{}}},isNew:!1,deleteId:"",deleteName:"",updateId:"",status:{fileUploading:!1},isLoading:!1}},methods:{getAllLocation:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,a=_["a"].firestore(),e.next=4,a.collection("data").onSnapshot((function(e){var a=e.docChanges();a.forEach((function(e){"added"===e.type&&t.data.push(Object(i["a"])({},e.doc.data(),{id:e.doc.id}))})),t.isLoading=!1}));case 4:case"end":return e.stop()}}),e)})))()},getLocation:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=3,o=e*a,s=_["a"].firestore();s.collection("data").get().then((function(n){var r=Math.ceil(n.size/a);o>n.size&&(o=n.size,a-=1);var c=n.docs[o-a],l=n.docs[o-1];s.collection("data").startAt(c).endAt(l).get().then((function(e){t.data=[],e.docChanges().forEach((function(e){t.data.push(Object(i["a"])({},e.doc.data(),{id:e.doc.id}))}))})),t.pagination={total_pages:r,current_page:e,has_pre:!1,has_next:!1,category:null}})).catch((function(t){console.log("Error getting documents",t)}))},openModal:function(t,e){t?(this.tempLocation={geometry:{type:"Point",coordinates:[]}},this.isNew=!0):(this.tempLocation=Object.assign({},e),this.updateId=this.tempLocation.id,this.isNew=!1),c()("#locationModal").modal("show")},updateLocation:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=_["a"].firestore(),t.isNew){e.next=8;break}return t.tempLocation.score=parseFloat(t.tempLocation.score),t.tempLocation.cost=parseInt(t.tempLocation.cost),e.next=6,a.collection("data").doc(t.tempLocation.id).update(t.tempLocation);case 6:e.next=12;break;case 8:return t.tempLocation.score=parseFloat(t.tempLocation.score),t.tempLocation.cost=parseInt(t.tempLocation.cost),e.next=12,a.collection("data").add(t.tempLocation);case 12:c()("#locationModal").modal("hide"),t.getLocation();case 14:case"end":return e.stop()}}),e)})))()},delModal:function(t){c()("#delLocationModal").modal("show"),this.deleteId=t.id,this.deleteName=t.name},deleteLocation:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,a=_["a"].firestore(),e.prev=2,e.next=5,a.collection("data").doc(t.deleteId).delete();case 5:c()("#delLocationModal").modal("hide"),console.log("刪除成功"),t.getLocation(),e.next=15;break;case 10:e.prev=10,e.t0=e["catch"](2),console.log(e.t0),c()("#delLocationModal").modal("hide"),t.getLocation();case 15:t.isLoading=!1;case 16:case"end":return e.stop()}}),e,null,[[2,10]])})))()},uploadFile:function(){var t=this.$refs.files.files[0],e=this,a=new FormData;a.append("file-to-upload",t);var o="".concat(Object({VUE_APP_APIKEY:"AIzaSyDxMe0rz5sBePaiA8y1_T9wjMFWRySYya8",VUE_APP_APPID:"1:757039206758:web:1ab52794345db4559338a7",NODE_ENV:"production",BASE_URL:"/searchfun_firebase/"}).VUE_APP_APIPATH,"/api/").concat(Object({VUE_APP_APIKEY:"AIzaSyDxMe0rz5sBePaiA8y1_T9wjMFWRySYya8",VUE_APP_APPID:"1:757039206758:web:1ab52794345db4559338a7",NODE_ENV:"production",BASE_URL:"/searchfun_firebase/"}).VUE_APP_CUSTOMPATH,"/admin/upload");e.status.fileUploading=!0,this.$http.post(o,a,{headers:{"content-Type":"multipart/form-data"}}).then((function(t){console.log(t.data),e.status.fileUploading=!1,t.data.success&&e.$set(e.tempProduct,"imageUrl",t.data.imageUrl)}))},signout:function(){var t=this;_["a"].auth().signOut().then((function(){t.$router.push("/login"),window.location.reload()})).catch((function(t){console.log(t.message)}))},citySearch:function(){var t=this;this.isLoading=!0;var e=_["a"].firestore();e.collection("data").where("county","==",this.select.city).get().then((function(e){t.data=[],e.docChanges().forEach((function(e){t.data.push(Object(i["a"])({},e.doc.data(),{id:e.doc.id}))})),""===t.select.city&&t.getLocation(),t.isLoading=!1})).catch((function(t){console.log("Error getting documents",t)}))},search:function(){var t=this;if(this.searchText){var e=this.data.filter((function(e){return e.name.includes(t.searchText)}));this.filterData=e}}},mounted:function(){this.getLocation()}},y=b,L=(a("1409"),Object(p["a"])(y,o,s,!1,null,"1639d88c",null));e["default"]=L.exports},"90d4":function(t,e,a){},a755:function(t,e,a){},cc41:function(t,e,a){"use strict";var o=a("a755"),s=a.n(o);s.a}}]);
//# sourceMappingURL=chunk-15e98ed1.480601d7.js.map